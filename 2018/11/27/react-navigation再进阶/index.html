<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.0.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.0.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: true,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="如果在学习react-native的过程中遇到什么问题，欢迎加入QQ群397885169一起学习，一起成长。  本文是基于最新的react-navigation^2.14.2来书写的。  前言关于react-navigation的文章，这已经是第三篇了，这个库从最初的beta版到最新的2.x版本，更新频率是很快的，这个库也越来越完善，很多1.x的技巧已经完全不适用于新的版本，然而群里每天又有很多人">
<meta property="og:type" content="article">
<meta property="og:title" content="react-navigation使用技巧（再进阶）">
<meta property="og:url" content="https://coderabbit.dev/2018/11/27/react-navigation再进阶/index.html">
<meta property="og:site_name" content="于广吉">
<meta property="og:description" content="如果在学习react-native的过程中遇到什么问题，欢迎加入QQ群397885169一起学习，一起成长。  本文是基于最新的react-navigation^2.14.2来书写的。  前言关于react-navigation的文章，这已经是第三篇了，这个库从最初的beta版到最新的2.x版本，更新频率是很快的，这个库也越来越完善，很多1.x的技巧已经完全不适用于新的版本，然而群里每天又有很多人">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-03-29T13:49:00.405Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="react-navigation使用技巧（再进阶）">
<meta name="twitter:description" content="如果在学习react-native的过程中遇到什么问题，欢迎加入QQ群397885169一起学习，一起成长。  本文是基于最新的react-navigation^2.14.2来书写的。  前言关于react-navigation的文章，这已经是第三篇了，这个库从最初的beta版到最新的2.x版本，更新频率是很快的，这个库也越来越完善，很多1.x的技巧已经完全不适用于新的版本，然而群里每天又有很多人">






  <link rel="canonical" href="https://coderabbit.dev/2018/11/27/react-navigation再进阶/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>react-navigation使用技巧（再进阶） | 于广吉</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">于广吉</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <h1 class="site-subtitle" itemprop="description">请对代码保持足够的好奇心！</h1>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    
  
  
  
  

  

  <a href="https://github.com/CodeRabbitYu" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewbox="0 0 250 250" style="fill: #222; color: #fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a>



    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  
    <div class="reading-progress-bar"></div>
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://coderabbit.dev/2018/11/27/react-navigation再进阶/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CodeRabbit">
      <meta itemprop="description" content="学无止境">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="于广吉">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">react-navigation使用技巧（再进阶）

              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-11-27 17:00:07" itemprop="dateCreated datePublished" datetime="2018-11-27T17:00:07+08:00">2018-11-27</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-03-29 21:49:00" itemprop="dateModified" datetime="2019-03-29T21:49:00+08:00">2019-03-29</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/React-Native/" itemprop="url" rel="index"><span itemprop="name">React-Native</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">12k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">11 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><strong>如果在学习react-native的过程中遇到什么问题，欢迎加入<a href="//shang.qq.com/wpa/qunwpa?idkey=22a86c4da6efbc7eb0ad38b037d40c21cf3451646fefdef721b50e1edc1adf92">QQ群397885169</a>一起学习，一起成长。</strong></p>
<blockquote>
<p>本文是基于最新的react-navigation<code>^2.14.2</code>来书写的。</p>
</blockquote>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>关于<code>react-navigation</code>的文章，这已经是第三篇了，这个库从最初的<code>beta</code>版到最新的<code>2.x</code>版本，更新频率是很快的，这个库也越来越完善，很多<code>1.x</code>的技巧已经完全不适用于新的版本，然而群里每天又有很多人再问，为了解(jiao)决(yu)这个问题，所以，动手写了这篇文章。</p>
<h3 id="更新版本react-navigation3-x！"><a href="#更新版本react-navigation3-x！" class="headerlink" title="更新版本react-navigation3.x！"></a>更新版本<code>react-navigation3.x</code>！</h3><blockquote>
<p>因为<code>react-navigation</code>版本更新到3.x了！，本文又一次更新啦！</p>
</blockquote>
<h3 id="文章链接"><a href="#文章链接" class="headerlink" title="文章链接"></a>文章链接</h3><blockquote>
<p><a href="https://www.jianshu.com/p/2f575cc35780" target="_blank" rel="noopener">react-navigation使用技巧</a> ： 适合初学者，基本讲解了2.x的api，3.x待更新<br><a href="https://www.jianshu.com/p/b877115fff1b" target="_blank" rel="noopener">react-navigation使用技巧(进阶篇)</a> ： 适合遇到某些问些不知如何解决的人，廉颇老矣，尚能饭否。<br><a href="https://www.jianshu.com/p/dc9df5826651" target="_blank" rel="noopener">react-navigation使用技巧（再进阶）</a> ： 本篇文章，适合对于新版本(2.x，3.x)有疑问的人，对新的Api做了讲解</p>
</blockquote>
<a id="more"></a>
<h2 id="问题-amp-技巧"><a href="#问题-amp-技巧" class="headerlink" title="问题&amp;技巧"></a>问题&amp;技巧</h2><h3 id="安装react-navigation3-x直接报错"><a href="#安装react-navigation3-x直接报错" class="headerlink" title="安装react-navigation3.x直接报错"></a>安装<code>react-navigation3.x</code>直接报错</h3><p>因为在新版本中，新增了一个原生库<code>react-native-gesture-handler</code>，所以，不管是升级还是新安装，都需要安装这个库，如果已经安装过了，请无视。</p>
<p>安装并link过后，能解决百分之50的问题。下一个解决另一半问题</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yarn add react-native-gesture-handler</span><br><span class="line">react-native link react-native-gesture-handler</span><br></pre></td></tr></table></figure>
<h3 id="安装3-x后，需要将最外层的包裹形式修改为createAppContainer"><a href="#安装3-x后，需要将最外层的包裹形式修改为createAppContainer" class="headerlink" title="安装3.x后，需要将最外层的包裹形式修改为createAppContainer"></a>安装<code>3.x</code>后，需要将最外层的包裹形式修改为<code>createAppContainer</code></h3><p>在之前的版本中，使用<code>createStackNavigator</code>后，就会自动实现<code>createAppContainer</code>，但在新版本中，需要手动使用<code>createAppContainer</code>来包裹最外层的路由。</p>
<h4 id="以-识兔代码-为例"><a href="#以-识兔代码-为例" class="headerlink" title="以 识兔代码 为例"></a>以 <strong><a href="https://github.com/codeRabbitYu/ShiTu/blob/master/app/routers/AuthLoading.js" target="_blank" rel="noopener">识兔代码</a></strong> 为例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">export const AuthLoadingRouter = createAppContainer(</span><br><span class="line">  createSwitchNavigator(</span><br><span class="line">    &#123;</span><br><span class="line">      AuthLoading: AuthLoadingScreen,</span><br><span class="line">      AppRouter: AppRouter,</span><br><span class="line">      AuthRouter: AuthRouter</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      initialRouteName: &apos;AuthLoading&apos;</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p><code>createAppContainer</code> 提供了两个方法来使用</p>
<p><code>onNavigationStateChange</code>： 每次导航器管理的导航状态发生变化时调用的函数。它接收之前的状态，新的状态和发出状态变化的行为。默认情况下，它会将状态更改打印到控制台。</p>
<p><code>uriPrefix</code>：深度链接，处理深层链接路径时的方法</p>
<h3 id="模态动画"><a href="#模态动画" class="headerlink" title="模态动画"></a>模态动画</h3><p>作为一个前iOS开发者，从<code>react-navigation</code>beta版开始，就一直再等待类似<code>iOS</code>的<code>present</code>动画效果，虽然，可以使用<code>mode: modal</code>来实现效果，但这个是全局的，使用这个方法后，所有的页面跳转都是<code>modal</code>效果，这是不能容忍的。<br>在<code>1.x</code>之前，我试过用拆分<code>StackNavigator</code>的方式实现了效果，但代码不忍直视。</p>
<p>在<code>3.x</code>中，终于可以手动配置，让某些路由实现想要的动画了。</p>
<p>还是以<a href="https://github.com/SurpassRabbit/ShiTu/blob/master/app/routers/AppRouter.js" target="_blank" rel="noopener">识兔代码</a>为例，我将跳转登录的代码，改成了<code>Modal</code>动画。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import &#123; createBottomTabNavigator, createStackNavigator, StackViewTransitionConfigs &#125; from &apos;react-navigation&apos;;</span><br><span class="line"></span><br><span class="line">// 数组中的路由，可以自定义动画效果，这里我只改了登录</span><br><span class="line">const IOS_MODAL_ROUTES = [&apos;Login&apos;];</span><br><span class="line"></span><br><span class="line">const dynamicModalTransition = (transitionProps, prevTransitionProps) =&gt; &#123;</span><br><span class="line">  const isModal = IOS_MODAL_ROUTES.some(</span><br><span class="line">    screenName =&gt;</span><br><span class="line">      screenName === transitionProps.scene.route.routeName ||</span><br><span class="line">      (prevTransitionProps &amp;&amp; screenName === prevTransitionProps.scene.route.routeName)</span><br><span class="line">  )</span><br><span class="line">  return StackViewTransitionConfigs.defaultTransitionConfig(</span><br><span class="line">    transitionProps,</span><br><span class="line">    prevTransitionProps,</span><br><span class="line">    isModal</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const HomeStack = createStackNavigator(&#123;</span><br><span class="line">    MyTab: &#123;</span><br><span class="line">      screen: MyTab</span><br><span class="line">    &#125;, </span><br><span class="line">    BuDeJie: &#123;</span><br><span class="line">      screen: BuDeJie</span><br><span class="line">    &#125;, </span><br><span class="line">    Login: &#123;</span><br><span class="line">      screen: Login</span><br><span class="line">    &#125; </span><br><span class="line">&#125;,&#123; </span><br><span class="line">    initialRouteName: &apos;MyTab&apos;, </span><br><span class="line">    transitionConfig: dynamicModalTransition</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="点击Tab，滚动到页面顶部"><a href="#点击Tab，滚动到页面顶部" class="headerlink" title="点击Tab，滚动到页面顶部"></a>点击Tab，滚动到页面顶部</h3><p>这个也是<code>3.x</code>版本中，新增的东西，<code>react-navigation</code>导出了<code>ScrollView</code>，<code>FlatList</code>和<code>SectionList</code>。</p>
<p>导出的三个组件中，方法和原来的一样，只不过在内部实现了，滚动到顶部的方法。</p>
<p>看<code>issues</code>上有很多bug哦，慎用。</p>
<h3 id="新增defaultNavigationOptions"><a href="#新增defaultNavigationOptions" class="headerlink" title="新增defaultNavigationOptions"></a>新增defaultNavigationOptions</h3><p>之前初始化配置路由属性都是在<code>navigationOptions</code>中，这样虽然更便捷，但如果想在页面中修改却不行，不会覆盖初始值，在新版本中提供了<code>defaultNavigationOptions</code>，用法和之前一样，但终于可以在页面中覆盖初值了</p>
<h3 id="为什么无法修改跟路由的导航头，我想修改它的颜色，隐藏等等"><a href="#为什么无法修改跟路由的导航头，我想修改它的颜色，隐藏等等" class="headerlink" title="为什么无法修改跟路由的导航头，我想修改它的颜色，隐藏等等"></a>为什么无法修改跟路由的导航头，我想修改它的颜色，隐藏等等</h3><p>因为在<code>react-navigation2.x</code>版本中，作者将该库的路由包裹方式改了，之前<code>TabNavigator</code>中是包含了<code>StackNavigator</code>大部分属性的，所以，可以很简单的设置<code>header</code>，<code>headerStyle</code>，<code>headerTitle</code>等属性的。<br>新版本中，<code>createBottomTabNavigator</code>没有了这些属性，如果想要修改这些属性，有两种方式： </p>
<blockquote>
<ol>
<li>用<code>createStackNavigator</code>初始化页面，然后再用<code>createBottomTabNavigator</code>包裹再外层，最外层再用<code>createStackNavigator</code>包裹一遍，用来跳转其他子页面。</li>
</ol>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">const ShiTuStack = createStackNavigator(&#123;</span><br><span class="line">  ShiTu: ShiTu,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const BuDeJieStack = createStackNavigator(&#123;</span><br><span class="line">  BuDeJie: BuDeJie,</span><br><span class="line">  BuDeJieDetail: BuDeJieDetail,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const MyTab = createBottomTabNavigator(&#123;</span><br><span class="line">  Tabs: ShiTuStack,</span><br><span class="line">  Details: BuDeJieStack,</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const AppRouter = createStackNavigator(&#123;</span><br><span class="line">  Auth: AuthScreen,</span><br><span class="line">  MyTab: MyTab,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<ol start="2">
<li>使用<code>setParams</code>属性，在根路由页面的<code>componentDidMount</code>中调用</li>
</ol>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">this.props.navigation.setParams(&#123;title: &apos;识兔&apos;&#125;);</span><br></pre></td></tr></table></figure>
<p>接下来在路由页面中<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">export const AppRouter = createStackNavigator(&#123;</span><br><span class="line">	MyTab: &#123;</span><br><span class="line">		screen: MyTab,</span><br><span class="line">	&#125;,</span><br><span class="line">	BuDeJie: &#123;</span><br><span class="line">		screen: BuDeJie,</span><br><span class="line">	&#125;,</span><br><span class="line">&#125;, &#123;</span><br><span class="line">	   navigationOptions: (&#123;navigation&#125;) =&gt; NavigatorOptions(navigation)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">const NavigatorOptions = (navigation) =&gt; &#123;</span><br><span class="line">	const routes = navigation.state.routes;</span><br><span class="line">	// 通过params得到传进来的title，并赋值给headerTitle。</span><br><span class="line">	const params = routes ? routes[navigation.state.index].params : null;</span><br><span class="line">	const headerTitle = params ? params.title : &apos;&apos;;</span><br><span class="line">	const headerTitleStyle = &#123;</span><br><span class="line">		fontSize: System.iOS ? 23 : 20,</span><br><span class="line">		color: &apos;white&apos;,</span><br><span class="line">		flex: 1,</span><br><span class="line">		textAlign: &apos;center&apos;,</span><br><span class="line">		paddingTop: System.Android ? 17 : null,</span><br><span class="line">	&#125;;</span><br><span class="line">	const headerBackTitle = null;</span><br><span class="line">	const headerTintColor = &apos;white&apos;;</span><br><span class="line">	const headerStyle = &#123;</span><br><span class="line">		backgroundColor: Theme.navColor,</span><br><span class="line">		shadowColor: &apos;transparent&apos;,</span><br><span class="line">		shadowOpacity: 0,</span><br><span class="line">		borderBottomWidth: 0,</span><br><span class="line">		borderBottomColor: &apos;transparent&apos;,</span><br><span class="line">		elevation: 0,</span><br><span class="line">	&#125;;</span><br><span class="line">	const header = null;</span><br><span class="line">	return &#123; headerTitle, headerStyle, headerTitleStyle, headerBackTitle, headerTintColor, header &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>以上的两种方式，并不是很好的方式，<code>react-navigation</code>导航条的自定义性虽然越来越强了，但某些情况下还是没有完全自定义的导航更好控制，比如说我想监听到<code>react-navigation</code>自带导航的返回按钮，只能去页面中复写<code>headerLeft</code>属性，这样就不如，完全控制了。 </p>
<blockquote>
<p>我在<a href="https://github.com/SurpassRabbit/ShiTu" target="_blank" rel="noopener">识兔</a>中，提供了一套基于<code>teaset</code>的导航 + 适配页面，欢迎使用哦！</p>
</blockquote>
<h3 id="安卓实现类似iOS的push动画"><a href="#安卓实现类似iOS的push动画" class="headerlink" title="安卓实现类似iOS的push动画"></a>安卓实现类似iOS的push动画</h3><p>这个是老生常谈的问题了。我之前更新的文章中，有<code>1.x</code>版本和<code>2.10.x</code>版本之前的实现方式，但<code>2.13.0</code>又改了，这里把三种方式都整理出来。</p>
<p>三种的用法是一样的，只不过，引入文件的路径有修改。先把用法发出来。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    // 快速定制导航条，新版识兔中所有的导航都是重写的，所以这里会将全部的导航置空</span><br><span class="line">    navigationOptions: () =&gt; (&#123;	</span><br><span class="line">        header: null,	</span><br><span class="line">    	gesturesEnabled: true,	</span><br><span class="line">    &#125;),</span><br><span class="line">    transitionConfig: () =&gt; (&#123;</span><br><span class="line">    	screenInterpolator: StackViewStyleInterpolator.forHorizontal,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>官方一共提供了四种动画方式</p>
<blockquote>
<p>从右向左： forHorizontal  iOS默认效果<br>从下向上： forVertical<br>安卓那种的从下向上： forFadeFromBottomAndroid<br>无动画： forInitial</p>
</blockquote>
<p>如果想自定义的话，可以使用官方推荐的三方库<a href="https://github.com/fram-x/FluidTransitions" target="_blank" rel="noopener">FluidTransitions</a>。</p>
<p><code>2.13.0</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import StackViewStyleInterpolator from</span><br><span class="line"> &apos;react-navigation-stack/dist/views/StackView/StackViewStyleInterpolator&apos;;</span><br></pre></td></tr></table></figure>
<p><code>2.x</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import StackViewStyleInterpolator from </span><br><span class="line">&apos;react-navigation/src/views/StackView/StackViewStyleInterpolator&apos;;</span><br></pre></td></tr></table></figure>
<p><code>1.x</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import CardStackStyleInterpolator from</span><br><span class="line"> &apos;react-navigation/src/views/CardStack/CardStackStyleInterpolator&apos;;</span><br></pre></td></tr></table></figure>
<h3 id="让TabBar拥有点击事件"><a href="#让TabBar拥有点击事件" class="headerlink" title="让TabBar拥有点击事件"></a>让TabBar拥有点击事件</h3><p><code>react-navigation</code>最初的版本是没有这个事件的，那个时候，我手写了这个事件并暴露出去，后来官方添加了这个事件，只不过<code>1.x</code>和<code>2.x</code>的返回属性不一样，但方法名是一样的。</p>
<p><code>2.x</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">tabBarOnPress: async (obj: any) =&gt; &#123;</span><br><span class="line">    console.log(obj);</span><br><span class="line">    try &#123;</span><br><span class="line">        const userData = await AsyncStorage.getItem(&apos;USER_INFO&apos;);</span><br><span class="line">        if (userData) &#123;</span><br><span class="line">            obj.defaultHandler();</span><br><span class="line">        &#125;</span><br><span class="line">        else &#123;</span><br><span class="line">            obj.navigation.navigate(&apos;Login&apos;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; catch (e) &#123;</span><br><span class="line">        Toast.show(e.message, &apos;center&apos;, 1000);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>1.x</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tabBarOnPress:(obj)=&gt;&#123;</span><br><span class="line">    console.log(obj);</span><br><span class="line">    obj.jumpToIndex(obj.scene.index)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="重复跳转同一个页面"><a href="#重复跳转同一个页面" class="headerlink" title="重复跳转同一个页面"></a>重复跳转同一个页面</h3><p>经<code>晴明大神</code>指点，将该方法更新</p>
<p>重复跳转是可以用过<code>push</code>跳转的，但容易发生的问题就是可能会导致重复跳转该页面，而用<code>navigate</code>使通过<code>key</code>控制的，所以，基本可以保证不会重复跳转，而直接使用<code>this.props.navigate.navigate(&#39;Detail&#39;)</code>是不可行的，需要手动设置<code>key</code>，作为唯一标识。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">this.props.navigation.navigate(&#123;</span><br><span class="line">    key: user.id,</span><br><span class="line">    routeName: &apos;Detail&apos;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><del>想去同一个页面可以用<code>navigate</code>，但新版本中，这么做却不行了，因为<code>navigate</code>是根据<code>key</code>查找页面的，如果页面入栈就不跳转。 这里要使用不算新的api<code>push</code>咯，才能实现重复跳转。</del></p>
<h3 id="保持页面状态"><a href="#保持页面状态" class="headerlink" title="保持页面状态"></a>保持页面状态</h3><p>在开发RN的过程中，经常会遇到，我在开发一个页面，<code>reload</code>之后，又要重新进去，在<code>2.x</code>版本中，新增了一个实验性的api<code>persistenceKey</code>，它会自动保存当前页面的路由，并在<code>reload</code>之后默认打开该页面。</p>
<p>以识兔中路由层<code>index.js</code>为例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">const navigationPersistenceKey = __DEV__ ? &apos;NavigationStateDEV&apos; : null;</span><br><span class="line"></span><br><span class="line">&lt;AuthLoadingRouter persistenceKey=&#123;navigationPersistenceKey&#125;</span><br><span class="line"> 				   renderLoadingExperimental=&#123;() =&gt; &lt;ActivityIndicator size=&apos;large&apos; color=&apos;black&apos; /&gt;&#125;</span><br><span class="line">					/&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>persistenceKey</code>就是保持当前页面的key，通过存入<code>AsyncStorage</code>，在下次进入页面后，通过读取这个key来打开相应的页面。</p>
</blockquote>
<blockquote>
<p><code>renderLoadingExperimental</code>因为<code>AsyncStorage</code>是异步加载的，所以在取值过程中可能出现闪白的情况，可以使用这个属性，呈现加载视图</p>
</blockquote>
<p><strong>注：以上方式是实验性方法，可能在未来的版本中有变更</strong></p>
<h3 id="页面的生命周期"><a href="#页面的生命周期" class="headerlink" title="页面的生命周期"></a>页面的生命周期</h3><p>如果开发过原生都会知道，原生中每个页面都是有独立的生命周期的，以<code>iOS</code>为例。</p>
<ul>
<li><p><code>viewWillAppear</code>： 控制器的view将要显示</p>
</li>
<li><p><code>viewDidLoad</code>：view加载完毕</p>
</li>
<li><code>viewWillDisappear</code>：控制器的view即将消失的时候</li>
<li><code>viewDidAppear</code>：控制器的view完全显示</li>
</ul>
<p>从开发RN第一天开始，就很期待有这些生命周期，但<code>React</code>能用的页面生命周期很少，常用的有</p>
<ul>
<li><p><code>componentWillMount(快被废弃了)</code>：页面将要显示</p>
</li>
<li><p><code>componentDidMount</code>：页面已经显示</p>
</li>
<li><code>componentWillUnmount</code>：页面将要消失</li>
</ul>
<p>在<code>react-navigation</code>中终于实现了这个心愿，为页面添加了可用的生命周期。</p>
<ul>
<li><p><code>onWillBlur</code>：页面将要失去焦点</p>
</li>
<li><p><code>onDidBlur</code>：页面已经失去焦点</p>
</li>
<li><code>onWillFocus</code>：页面将要获得焦点</li>
<li><code>onDidFocus</code>：页面已经获得焦点</li>
</ul>
<p><code>react-navigation</code>提供了两种方式获取这个生命周期</p>
<h4 id="手动监听"><a href="#手动监听" class="headerlink" title="手动监听"></a>手动监听</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">componentDidMount() &#123;</span><br><span class="line">    // 通过addListener开启监听，可以使用上面的四个属性</span><br><span class="line">	this._didBlurSubscription = this.props.navigation.addListener(</span><br><span class="line">		&apos;didBlur&apos;,</span><br><span class="line">		payload =&gt; &#123;</span><br><span class="line">			console.debug(&apos;didBlur&apos;, payload);</span><br><span class="line">		&#125;</span><br><span class="line">	);</span><br><span class="line">&#125;</span><br><span class="line">componentWillUnmount() &#123;</span><br><span class="line">    // 在页面消失的时候，取消监听</span><br><span class="line">	this._didBlurSubscription &amp;&amp; this._didBlurSubscription.remove();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="通过组件方法监听"><a href="#通过组件方法监听" class="headerlink" title="通过组件方法监听"></a>通过组件方法监听</h4><p>下面这种方式，会自动处理取消监听</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;NavigationEvents </span><br><span class="line">    onWillFocus=&#123;onWillFocus&#125;</span><br><span class="line">	onDidFocus=&#123;onDidFocus&#125;</span><br><span class="line">	onWillBlur=&#123;onWillBlur&#125;</span><br><span class="line">	onDidBlur=&#123;onDidBlur&#125;	</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure>
<h3 id="处理安卓返回键"><a href="#处理安卓返回键" class="headerlink" title="处理安卓返回键"></a>处理安卓返回键</h3><p>介绍完生命周期之后，之前存在的各种问题都迎刃而解了，只要活用这几个生命周期，能完成很多麻烦的问题，比如说安卓的返回键，之前的处理方式是在<code>componentDidMount</code>订阅事件，在<code>componentWillUnmount</code>取消事件，但是<code>componentWillUnmount</code>只有在页面销毁的时候才会触发，这样就导致，很多时候要把返回事件写在很多个页面，分别监听和销毁，有了声明周期这个就简单了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">constructor(props) &#123;</span><br><span class="line">    super(props);</span><br><span class="line">    this._didFocusSubscription = props.navigation.addListener(&apos;didFocus&apos;, payload =&gt;</span><br><span class="line">      BackHandler.addEventListener(&apos;hardwareBackPress&apos;, this.onBackButtonPressAndroid)</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    this._willBlurSubscription = this.props.navigation.addListener(&apos;willBlur&apos;, payload =&gt;</span><br><span class="line">      BackHandler.removeEventListener(&apos;hardwareBackPress&apos;, this.onBackButtonPressAndroid)</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  onBackButtonPressAndroid = () =&gt; &#123;</span><br><span class="line">    if (this.isSelectionModeEnabled()) &#123;</span><br><span class="line">      this.disableSelectionMode();</span><br><span class="line">      return true;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      return false;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  componentWillUnmount() &#123;</span><br><span class="line">    this._didFocusSubscription &amp;&amp; this._didFocusSubscription.remove();</span><br><span class="line">    this._willBlurSubscription &amp;&amp; this._willBlurSubscription.remove();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    // ...</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h3 id="iPhoneX适配和安卓异形屏适配"><a href="#iPhoneX适配和安卓异形屏适配" class="headerlink" title="iPhoneX适配和安卓异形屏适配"></a>iPhoneX适配和安卓异形屏适配</h3><p><code>react-navigation</code>中也提供了<code>SafeAreaView</code>这个组件，它会自动处理顶部导航栏和底部标签栏的适配，并且也会自动适配安卓的异形屏。用法和<code>react-native</code>提供的也类似。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;SafeAreaView style=&#123;styles.container&#125;&gt;</span><br><span class="line">        &lt;Text style=&#123;styles.paragraph&#125;&gt;</span><br><span class="line">          This is top text.</span><br><span class="line">        &lt;/Text&gt;</span><br><span class="line">        &lt;Text style=&#123;styles.paragraph&#125;&gt;</span><br><span class="line">          This is bottom text.</span><br><span class="line">        &lt;/Text&gt;</span><br><span class="line">      &lt;/SafeAreaView&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h3 id="在任何页面或者组件中都得到navigation对象"><a href="#在任何页面或者组件中都得到navigation对象" class="headerlink" title="在任何页面或者组件中都得到navigation对象"></a>在任何页面或者组件中都得到<code>navigation</code>对象</h3><p>在很多情况下，我们的组件或者页面需要得到<code>this.props.navigation</code>对象，但是会报错，说没有找到<code>navigation</code>对象，为了解决这个问题，在<code>react-navigation</code>中提供了一个高阶组件<code>withNavigation</code>来应对。</p>
<p><strong>注：页面中没有<code>navigation</code>对象，一般都是没有在初始化路由的时候注册该页面，所以请先检查自己的写法，然后再使用该组件</strong><br><strong>注：该组件最好的使用场景，应该是组件中，比如说返回按钮，或者跳转按钮等等</strong></p>
<h4 id="在这里提供识兔中返回按钮的代码"><a href="#在这里提供识兔中返回按钮的代码" class="headerlink" title="在这里提供识兔中返回按钮的代码"></a>在这里提供<a href="https://github.com/SurpassRabbit/ShiTu/tree/master/app/components/NavigatorBar/index" target="_blank" rel="noopener">识兔中返回按钮</a>的代码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">import &#123; withNavigation &#125; from &apos;react-navigation&apos;;</span><br><span class="line"></span><br><span class="line">class NavigatorBar extends React.PureComponent&lt;Props&gt; &#123;</span><br><span class="line">    backButtonPress = () =&gt; &#123;</span><br><span class="line">    	const &#123;backButtonPress&#125; = this.props;</span><br><span class="line">    	if (backButtonPress) &#123;</span><br><span class="line">    		backButtonPress();</span><br><span class="line">    	&#125; else &#123;</span><br><span class="line">    		this.props.navigation.goBack();</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    renderLeftView = () =&gt; &#123;</span><br><span class="line">    	const &#123;isTopNavigator, leftView, &#125; = this.props;</span><br><span class="line">    	let left;</span><br><span class="line">    	if (isTopNavigator || leftView) &#123;</span><br><span class="line">    		left = leftView;</span><br><span class="line">    	&#125; else &#123;</span><br><span class="line">    		left = &lt;NavigationBar.BackButton title=&apos;返回&apos; onPress=&#123;this.backButtonPress&#125;/&gt;;</span><br><span class="line">    	&#125;</span><br><span class="line">    	return left;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    render() &#123;</span><br><span class="line">    	return (</span><br><span class="line">    		&lt;NavigationBar leftView=&#123;this.renderLeftView()&#125;							</span><br><span class="line">    		               titleStyle=&#123;&#123;fontSize: System.iOS ? 23 : 20, color: &apos;white&apos;, fontWeight: &apos;bold&apos;&#125;&#125;</span><br><span class="line">    		               &#123;...this.props&#125;</span><br><span class="line">    		/&gt;</span><br><span class="line">    	);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">export default withNavigation(NavigatorBar);</span><br></pre></td></tr></table></figure>
<h3 id="隐藏标签栏"><a href="#隐藏标签栏" class="headerlink" title="隐藏标签栏"></a>隐藏标签栏</h3><p>正常情况下，都会用<code>createStackNavigator</code>包裹<code>createBottomTabNavigator</code>，但就是存在不正常的情况呢? 那应该怎么处理tab的隐藏显示呢？其实很简单</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">const AppRouter = createStackNavigator(&#123;</span><br><span class="line">  MyTab: MyTab,</span><br><span class="line">  BuDeJie: BuDeJie,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">BuDeJie.navigationOptions = (&#123; navigation &#125;) =&gt; &#123;</span><br><span class="line">  let tabBarVisible = true;</span><br><span class="line">  if (navigation.state.index &gt; 0) &#123;</span><br><span class="line">    tabBarVisible = false;</span><br><span class="line">  &#125;</span><br><span class="line">  return &#123;</span><br><span class="line">    tabBarVisible,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>以上是我整理的15条关于新版<code>react-navigation</code>的进阶教程，如果还需要什么新的教程，欢迎加入<a href="//shang.qq.com/wpa/qunwpa?idkey=22a86c4da6efbc7eb0ad38b037d40c21cf3451646fefdef721b50e1edc1adf92">QQ群397885169</a>一起学习，一起成长。</p>
<p><code>react-navigation3.x</code>版本，强烈推荐更新，虽然还是有一些痛点，但可以看到这个库还是在不断完善的，相信它和RN会越来越好。</p>
<p><strong>以上10条，在我<a href="https://github.com/SurpassRabbit/ShiTu" target="_blank" rel="noopener">开源的识兔</a>中，都是可以找到实例的，欢迎参考，欢迎star</strong></p>

      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      
      
      

       <div>
        
        <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">------ 本文结束------</div>
    
</div>
        
      </div>

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/09/18/react-native0.57版本迁移教程/" rel="next" title="react-native版本迁移教程">
                <i class="fa fa-chevron-left"></i> react-native版本迁移教程
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/03/29/React Hook使用技巧/" rel="prev" title="React Hook使用技巧">
                React Hook使用技巧 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
   
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="CodeRabbit">
            
              <p class="site-author-name" itemprop="name">CodeRabbit</p>
              <div class="site-description motion-element" itemprop="description">学无止境</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives">
                
                    <span class="site-state-item-count">10</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">2</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
            </nav>
          

          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/coderabbityu" title="GitHub &rarr; https://github.com/coderabbityu" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#更新版本react-navigation3-x！"><span class="nav-number">1.1.</span> <span class="nav-text">更新版本react-navigation3.x！</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#文章链接"><span class="nav-number">1.2.</span> <span class="nav-text">文章链接</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#问题-amp-技巧"><span class="nav-number">2.</span> <span class="nav-text">问题&amp;技巧</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#安装react-navigation3-x直接报错"><span class="nav-number">2.1.</span> <span class="nav-text">安装react-navigation3.x直接报错</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安装3-x后，需要将最外层的包裹形式修改为createAppContainer"><span class="nav-number">2.2.</span> <span class="nav-text">安装3.x后，需要将最外层的包裹形式修改为createAppContainer</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#以-识兔代码-为例"><span class="nav-number">2.2.1.</span> <span class="nav-text">以 识兔代码 为例</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#模态动画"><span class="nav-number">2.3.</span> <span class="nav-text">模态动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#点击Tab，滚动到页面顶部"><span class="nav-number">2.4.</span> <span class="nav-text">点击Tab，滚动到页面顶部</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#新增defaultNavigationOptions"><span class="nav-number">2.5.</span> <span class="nav-text">新增defaultNavigationOptions</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#为什么无法修改跟路由的导航头，我想修改它的颜色，隐藏等等"><span class="nav-number">2.6.</span> <span class="nav-text">为什么无法修改跟路由的导航头，我想修改它的颜色，隐藏等等</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安卓实现类似iOS的push动画"><span class="nav-number">2.7.</span> <span class="nav-text">安卓实现类似iOS的push动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#让TabBar拥有点击事件"><span class="nav-number">2.8.</span> <span class="nav-text">让TabBar拥有点击事件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#重复跳转同一个页面"><span class="nav-number">2.9.</span> <span class="nav-text">重复跳转同一个页面</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#保持页面状态"><span class="nav-number">2.10.</span> <span class="nav-text">保持页面状态</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#页面的生命周期"><span class="nav-number">2.11.</span> <span class="nav-text">页面的生命周期</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#手动监听"><span class="nav-number">2.11.1.</span> <span class="nav-text">手动监听</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#通过组件方法监听"><span class="nav-number">2.11.2.</span> <span class="nav-text">通过组件方法监听</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#处理安卓返回键"><span class="nav-number">2.12.</span> <span class="nav-text">处理安卓返回键</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#iPhoneX适配和安卓异形屏适配"><span class="nav-number">2.13.</span> <span class="nav-text">iPhoneX适配和安卓异形屏适配</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#在任何页面或者组件中都得到navigation对象"><span class="nav-number">2.14.</span> <span class="nav-text">在任何页面或者组件中都得到navigation对象</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#在这里提供识兔中返回按钮的代码"><span class="nav-number">2.14.1.</span> <span class="nav-text">在这里提供识兔中返回按钮的代码</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#隐藏标签栏"><span class="nav-number">2.15.</span> <span class="nav-text">隐藏标签栏</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#总结"><span class="nav-number">3.</span> <span class="nav-text">总结</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CodeRabbit</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">站点总字数：</span>
    
    <span title="站点总字数">75k</span>
  

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    
    <span title="站点阅读时长">1:08</span>
  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.0.1</div>




        








        
      </div>
    </footer>

    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>














  
    
    
  
  <script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script>











  



  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script src="/lib/reading_progress/reading_progress.js"></script>


  


  <script src="/js/src/utils.js?v=7.0.1"></script>

  <script src="/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/src/affix.js?v=7.0.1"></script>

  <script src="/js/src/schemes/pisces.js?v=7.0.1"></script>




  
  <script src="/js/src/scrollspy.js?v=7.0.1"></script>
<script src="/js/src/post-details.js?v=7.0.1"></script>



  


  <script src="/js/src/next-boot.js?v=7.0.1"></script>


  

  

  

  


  


  




  

  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
